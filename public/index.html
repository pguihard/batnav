<html>
    <head>
        <title>test2</title>
        <meta name="viewport" content="width=device-width" />
        <link rel="stylesheet" href="css/style.css" />
        <script src="http://code.jquery.com/jquery-3.5.1.min.js"></script>
        <script src="/socket.io/socket.io.js"></script>
    </head>
    <body>
        <div>
            <h2>DÃ©mo Node.js + Socket IO</h2>
            <div class=timestamp id="timestamp"></div>
            <div class="client" id="client"></div>
            <div class="clients" id="clients"></div>
            <p>
                <input type="text" class="tosend" id="toSend">
                <button id="poke">Send</button>
            </p>
            <label for="message">Received message:</label>
            <div class=message id="message"></div>
        </div>
    </body>
</html>
<script type="text/javascript">
    $(document).ready(function () {
        var sock = io();
        sock.on("message", function (data) {
            var obj = JSON.parse(data);
            if (obj.message == "disconnect"){
                sock.disconnect();
                window.location.replace("Rejected.html");
                return;
            }
            if(obj.message) {
                $("#message").text(obj.message);
            }
            else {
                $("#timestamp").text(obj.timestamp);
                $("#client").text(obj.client);
                $("#clients").text(obj.clients);
            }
        });
        sock.connect();
        $("#poke").click(function() {
            textClients = document.getElementById("clients").innerText;
            if(textClients == "1 players" ){
                $("#message").text("There is nobody connected to receive your message!");
                return;
            }
            sock.send(document.getElementById("toSend").value); });
    });
</script>
